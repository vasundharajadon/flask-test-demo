<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Registered Users</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
</head>
  <body>
    <div class="container mt-5">
      <h2 class="mb-4 text-center">All Registered Users</h2>
      <a href="/" class="btn btn-primary mb-3">Back to Registration</a>
      <table class="table table-bordered table-hover shadow-sm">
        <thead class="table-light">
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Email</th>
            <th>Password</th>
          </tr>
        </thead>
        <tbody>
          {% for user in users %}
          <tr>
            <td>{{ user.id }}</td>
            <td>{{ user.name }}</td>
            <td>{{ user.email }}</td>
            <td>
              <span id="pw-{{ loop.index }}" class="password-mask">****</span>
              <button
                class="btn btn-sm btn-outline-secondary ms-2"
                onclick="togglePassword({{ loop.index }}, '{{ user.password }}')"
              >
                <i class="bi bi-eye"></i>
              </button>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <script>
      function togglePassword(index, actualPassword) {
        const pwEl = document.getElementById("pw-" + index);
        const iconEl = pwEl.nextElementSibling.querySelector("i");
        if (pwEl.innerText === "****") {
          pwEl.innerText = actualPassword;
          iconEl.classList.remove("bi-eye");
          iconEl.classList.add("bi-eye-slash");
        } else {
          pwEl.innerText = "****";
          iconEl.classList.remove("bi-eye-slash");
          iconEl.classList.add("bi-eye");
        }
      }
    </script>
  </body>
</html>
